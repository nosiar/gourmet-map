{% extends "base.html" %}

{% block head %}
<script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?clientId=fsTvRBUeUiobhQZtiWzE&submodules=geocoder"></script>
<script type="text/javascript">

$(function() {
  var map = new naver.maps.Map('map', {
    center: new naver.maps.Point(316281, 545370),
    zoom: 11,
    mapTypes: new naver.maps.MapTypeRegistry({
      'normal': naver.maps.NaverMapTypeOption.getNormalMap({
        projection: naver.maps.TM128Coord
      }),
      'terrain': naver.maps.NaverMapTypeOption.getTerrainMap({
        projection: naver.maps.TM128Coord
      }),
      'satellite': naver.maps.NaverMapTypeOption.getSatelliteMap({
        projection: naver.maps.TM128Coord
      }),
      'hybrid': naver.maps.NaverMapTypeOption.getHybridMap({
        projection: naver.maps.TM128Coord
      })
    }),
    mapTypeId: naver.maps.MapTypeId.TERRAIN
  });

  var infowindow = new naver.maps.InfoWindow();
});
</script>
{% endblock %}
{% block content %}
<div id="map" style="width:100%;height:500px;"></div>
{% endblock %}
  function msg(str) {
    var center = map.getCenter();
    infowindow.setContent('<div style="padding:20px;">' + str +'</div>');
    infowindow.open(map, center);
  }

  function err(str) {
    msg('<h5 style="margin-bottom:5px;color:#f00;">' + str + '</h5>');
  }

  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(onSuccessGeolocation, onErrorGeolocation);
  } else {
    err("Geolocation not supported");
  }

  function onSuccessGeolocation(position) {
    var location = new naver.maps.LatLng(position.coords.latitude,
                                         position.coords.longitude);
    location = naver.maps.TransCoord.fromLatLngToTM128(location);

    map.setCenter(location);

    var marker = new naver.maps.Marker({
      position: location,
      map: map
    });
  }

  function onErrorGeolocation() {
    err("Geolocation failed!");
  }
